{% extends "base.html" %}
{% block title %}Forgot Password{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center px-4">
  <div class="max-w-md w-full bg-white rounded-2xl shadow-xl p-8">

    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-800">Forgot Password?</h1>
      <p class="text-gray-600 mt-2">Weâ€™ll send you a link to reset your password</p>
    </div>

    <div class="space-y-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
        <input type="email" id="email" required placeholder="you@example.com"
               class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500">
      </div>

      <button id="sendBtn" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 rounded-lg hover:shadow-lg transition">
        Send Reset Link
      </button>
    </div>

    <div class="mt-8 text-center text-sm text-gray-600">
      <p>Remember password? <a href="/login" class="text-purple-600 font-bold hover:underline">Sign in</a></p>
    </div>
  </div>
</div>

<script>
document.getElementById('sendBtn').onclick = async () => {
  const email = document.getElementById('email').value.trim();
  const btn = document.getElementById('sendBtn');

  if (!email) {
    showToast("Please enter your email", "error");
    return;
  }

  btn.disabled = true;
  btn.textContent = "Sending...";

  try {
    const res = await fetch('/api/auth/forgot-password', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email })
    });
    const data = await res.json();

    if (res.ok || data.message) {
      showToast("Reset link sent! Check your email", "success");
      document.getElementById('email').value = '';
    } else {
      showToast(data.error || "Failed to send email", "error");
    }
  } catch (err) {
    showToast("Network error", "error");
  } finally {
    btn.disabled = false;
    btn.textContent = "Send Reset Link";
  }
};
</script>
{% endblock %}